{"name":"CloudModule for Zabbix","tagline":"Hybrid Cloud Monitoring Zabbix Loadable Module.","body":"# About\r\n\r\n**CloudModule for Zabbix**\r\n\r\nHybrid Cloud Monitoring Module by using Deltacloud.  \r\nThis tool is for Zabbix Loadable Module.\r\n\r\nZabbix loadable modules is supported over Zabbix 2.2.0.\r\n\r\n# Features\r\n\r\n* Automatically registration EC2 instances information.\r\n* Automatically registration EC2 CloudWatch metrics information.\r\n\r\n# Requirements\r\n\r\n* Setup Deltacloud server. (tested in Deltacloud 1.1.3)\r\n* libdeltacloud customized for this tool\r\n* Zabbix >= 2.2.0\r\n\r\n# Installation\r\n\r\n## 1. Install Deltacloud\r\n\r\nDeltacloud is made by Ruby.  \r\nSo, please install ruby (>= 1.9.2).\r\n\r\nAnd, install rubygems.\r\n\r\nYou can install deltacloud by using gem command.\r\n\r\n    $ sudo gem install splite3 deltacloud-core\r\n\r\nIf you have installed thin >= 2.0.0, please reinstall thin version 1.6.2\r\n\r\n    $ sudo gem uninstall thin\r\n    $ sudo gem install thin --version=1.6.2\r\n\r\nIf you have installed haml >= 4.0.5, please reinstall haml version 4.0.4\r\n\r\n    $ sudo gem uninstall haml\r\n    $ sudo gem install haml --version=4.0.4\r\n \r\n## 2. Apply one patch to Deltacloud\r\n\r\nIt is not possible to get AWS CloudWatch metrics from Deltacloud 1.1.3.\r\nSo, please apply patch <https://github.com/ike-dai/deltacloud-core/commit/61b690698c949fb7c92607651f1ctc5e02971df966>.\r\n\r\n    $ cd <rubygems dircetory>/deltacloud-core-1.1.3\r\n    $ vim lib/deltacloud/drivers/ec2/ec2_driver.rb\r\n        #start_time, end_time, metric_unit_for(p.name), { m.entity => opts[:id]})     <- comment out\r\n        start_time, end_time, metric_unit_for(p.name), {:dimensions => { m.entity => opts[:id]}})\r\n\r\n\r\n## 3. Start deltacloudd\r\n\r\n**Please start Deltacloud daemon.**\r\n\r\n    $ sudo deltacloudd -i ec2 -p 3000 &\r\n\r\n## 4. Install libdeltacloud-for-cloudmodule\r\n\r\n**Clone libdeltacloud-for-cloudmodule git repository from GitHub.**\r\n\r\n    $ git clone https://github.com/ike-dai/libdeltacloud-for-cloudmodule.git\r\n\r\n**Complile & Install**\r\n\r\n    $ sudo yum install libtool\r\n    $ sudo yum install libcurl-devel\r\n    $ cd libdeltacloud-for-cloudmodule\r\n    $ ./autogen.sh\r\n    $ ./configure\r\n    $ make\r\n    $ sudo make install\r\n\r\n(As default, this library will be installed in /usr/local/lib.)\r\n\r\n**Update shared library path.**\r\n\r\n    $ sudo vim /etc/ld.so.conf.d/libdeltacloud.conf\r\n    /usr/local/lib\r\n    $ sudo ldconfig\r\n\r\n## 5. Compile & Install CloudModule\r\n\r\n**Clone CloudModule git repository from GitHub.**\r\n\r\n    $ git clone https://github.com/ike-dai/zabbix-cloud-module.git\r\n\r\nCopy Makefile & source code to Zabbix source code directory.  \r\nIf you don't have Zabbix source code, please download it.\r\n\r\n    $ wget http://jaist.dl.sourceforge.net/project/zabbix/ZABBIX%20Latest%20Stable/2.2.4/zabbix-2.2.4.tar.gz\r\n    $ tar xvzf zabbix-2.2.4.tar.gz\r\n    $ cd zabbix-2.2.4\r\n    $ ./configure --enable-server --with-sqlite3\r\n    $ make\r\n\r\n    $ cp -r zabbix-cloud-module ./src/modules/\r\n\r\n**Complile**\r\n\r\n    $ cd src/modules/zabbix-cloud-module\r\n    $ make\r\n\r\n**Error message**  \r\nIf you get the following error, please recompile libs/zbxmemory/memalloc.c\r\n\r\n    gcc -shared -o cloud_module.so cloud_module.c ../../libs/zbxmemory/memalloc.o -I../../../include -ldeltacloud -fPIC\r\n    /usr/bin/ld: ../../libs/zbxmemory/memalloc.o: relocation R_X86_64_32 against `.rodata.str1.8' can not be used when making a shared object; recompile with -fPIC\r\n    ../../libs/zbxmemory/memalloc.o: could not read symbols: Bad value\r\n    collect2: ld returned 1 exit status\r\n\r\n    $ cd src/libs/zbxmemory/\r\n    $ make clean\r\n    $ vi Makefile\r\n    CFLAGS = -g -O2     -I/usr/include -fPIC   <--- Add \"-fPIC\"\r\n    $ make\r\n\r\n\r\n**Copy the shared library file.**\r\n\r\n    $ mkdir /usr/lib/zabbix/modules\r\n    $ cp cloud_module.so /usr/lib/zabbix/modules/\r\n\r\n## 6. Copy configurateion file\r\n\r\nPlease copy cloud_module.conf.example to /etc/zabbix/cloud_module.conf.\r\nAnd set values.\r\n\r\n    $ cp cloud_module.conf.example /etc/zabbix/cloud_module.conf\r\n    $ vim /etc/zabbix/cloud_module.conf\r\n    ModuleTimeout=300\r\n    ModuleCloudCacheSize=4M\r\n    ZabbixFile=\"/etc/zabbix/zabbix_server.conf\"\r\n\r\n**Notes: cloud_module.conf must be placed under \"/etc/zabbix\" directory.**\r\n\r\n## 7. Set LoadableModule configurations\r\n\r\nPlease set LoadableModulePath,LoadableModule in zabbix_server.conf(or zabbix_agentd.conf)  \r\nLoadable Module is used in Zabbix Server or Zabbix Agent.\r\n\r\n* When you can use in Zabbix Server(as Simple check item), please edit \"zabbix_server.conf\".\r\n* When you can use in Zabbix Agent(as Zabbix Agent item), please edit \"zabbix_agentd.conf\".\r\n\r\n    $ vim /etc/zabbix/zabbix_server.conf\r\n    \r\n    LoadableModulePath=/usr/lib/zabbix/modules\r\n    LoadableModule=cloud_module.so\r\n\r\n## 8. Import CloudModule template to Zabbix server\r\n \r\nPlease import templates/cloud_module_templates.xml in Zabbix frontend [Configuration] -> [Templates] -> [Import]\r\n\r\nBy importing this xml, two templates will be added.\r\n\r\n* Template Cloud Module\r\n* Template Cloud Module VM\r\n\r\n\r\n## 9. Add Cloud monitoring host\r\n\r\nAdd host.\r\n\r\nFor example:\r\n\r\n* Host name: AWS Account A\r\n* Host group: Cloud monitoring\r\n* Interface: Any (This module does not use interface information.)\r\n* Templates: Template Cloud Module\r\n* Macros:\r\n    * {$DELTACLOUD_DRIVER} -> ec2 (Now this module support only ec2)\r\n    * {$DELTACLOUD_PASSWORD} -> AWS API Secret key\r\n    * {$DELTACLOUD_PROVIDER} -> ap-northeast-1 (support any other region name)\r\n    * {$DELTACLOUD_URL} -> http://localhost:3000/api (please set your deltacloud URL)\r\n    * {$DELTACLOUD_USERNAME} -> AWS API Access key\r\n\r\nWhen these settings are finished, monitoring the status of AWS will start automatically.\r\n\r\n\r\n\r\n# Contact\r\n\r\nPlease send feedback to me.\r\n\r\nDAISUKE Ikeda\r\n\r\nTwitter: [@ike_dai](https://twitter.com/ike_dai)\r\n\r\ne-mail: <dai.ikd123@gmail.com>\r\n\r\n# License\r\n\r\nCloudModule for Zabbix is released under the GNU General Public License version2.\r\nThe GPL official full text is published at this [link](http://www.gnu.org/licenses/old-licenses/gpl-2.0.txt).\r\n\r\nCopyright 2014 DAISUKE Ikeda.\r\n\r\n\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}